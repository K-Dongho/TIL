# 트랜잭션 (Transaction)

### 트랜잭션 (Transaction)

트랜잭션은 작업의 완전성을 보장해 주는 것이다. 논리적인 작업 셋을 완벽하게 처리 하지 못할 경우에는 원 상태로 복구해서 작업의 일부만 적용되는 현상이 발생하지 않게 만들어주는 기능이다.

#

### 트랜잭션의 특성

- 원자성 (Atomicity)

  만약 트랜잭션 중간에 어떠한 문제가 발생한다면 트랜잭션에 해당하는 어떠한 작업 내용도 수행되어서는 안되며 아무런 문제가 발생되지 않았을 경우에만 모든 작업이 수행되어야 한다.

- 일관성 (Consistency)

  트랜잭션이 완료된 다음의 상태에서도 트랜잭션이 일어나기 전의 상황과 동일하게 데이터의 일관성을 보장해야 한다. 트랜잭션이 진행되는 동안에 데이터베이스가 변경되더라도 업데이트된 데이터베이스로 트랜잭션이 진행되는 것이 아니라 처음에 트랜잭션을 진행하기 위해 참조한 데이터베이스로 진행해야 한다.

- 독립성 (Isolation)

  둘 이상의 트랜잭션이 동시에 실행되어도 서로 간섭 없이 독립적으로 수행되어야 한다.

- 지속성(Durability)

  트랜잭션이 정상적으로 종료된 다음에는 영구적으로 데이터베이스에 작업 결과가 저장되어야 한다.

#

### 트랜잭션의 Commit, Rollback

- Commit은 하나의 트랜잭션이 성공적으로 끝났고 데이터베이스가 일관성 있는 상태일 때 하나의 트랜잭션이 끝났다는 것을 알려주기 위해 사용된다.

- Rollback은 하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션의 원자성이 깨진 경우 트랜잭션을 처음부터 다시 시작하거나 부분적으로만 연산된 결과를 취소시킬 때 사용된다.

#

### 트랜잭션의 상태

- Active

  트랜잭션의 활동 상태. 트랜잭션이 실행 중이며 동작 중인 상태를 말한다.

- Failed

  트랜잭션 실패 상태. 트랜잭션이 더 이상 정상적으로 진행 할 수 없는 상태를 말한다.

- Partially Committed

  트랜잭션의 마지막 연산이 실행을 끝낸 직후의 상태. Commit 요청이 들어온 상태를 말한다.

- Committed

  트랜잭션 완료 상태. 트랜잭션이 정상적으로 완료되어 Commit을 정상적으로 완료한 상태를 말한다.

- Aborted

  트랜잭션이 취소 상태. 트랜잭션이 취소되고 트랜잭션 실행 이전 데이터로 돌아가 rollback 연산을 완료한 상태를 말한다.

#

### 트랜잭션을 사용할 때 주의할 점

트랜잭션은 꼭 필요한 최소의 코드에만 적용해야 한다. 일반적으로 데이터베이스 커넥션은 개수가 제한적이다. 각 단위 프로그램이 커넥션을 소유하는 시간이 길어진다면 사용 가능한 여유 커넥션의 개수는 줄어들게 된다. 그러다 어느 순간에는 각 단위 프로그램에서 커넥션을 가져가기 위해 기다려야 하는 상황이 발생할 수도 있다.
