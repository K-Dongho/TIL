# 옵티마이저 (Optimizer)

### 옵티마이저 (Optimizer)

옵티마이저는 가장 효율적인 방법으로 SQL 쿼리를 수행할 수 있도록 최적의 처리 경로를 생성해 주는 DBMS의 핵심 엔진이다. 쿼리문을 받으면 옵티마이저가 여러 가지의 실행 계획을 세우고 각 실행 계획의 예상 비용을 산정한 후 비교해 가장 최적의 실행 계획에 따라 쿼리를 수행하게 된다.

#

### 옵티마이저의 종류

- 규칙 기반 옵티마이저

  - 실행 계획을 결정할 때 미리 정해둔 규칙에 따라 쿼리를 수행한다.
  - 통계 정보를 참조하지 않기 때문에 같은 쿼리에 대해서 같은 실행 계획을 만든다.
  - 대상 테이블에 인덱스가 존재하면 우선 사용된다.

- 비용 기반 옵티마이저

  - 여러 가지의 실행 계획을 세우고 비용이 최소한으로 나온 실행 계획에 따라 쿼리를 수행한다.
  - 비용을 예측하기 위해서 테이블, 인덱스, 칼럼 등의 다양한 객체 통계정보와 시스템 통계정보를 이용한다. 통계정보가 없는 경우 비효율적인 실행계획을 수행할 수 있기 때문에 정확한 통계정보를 유지하는 것이 중요하다.
  - 최근 대부분의 DBMS에서 사용되고 있다.

#

### 옵티마이저 서브 엔진별 역할

- Parser

  SQL 문장을 이루는 개별 요소를 분석하고 파싱 해서 파싱 트리를 생성한다.

- Optimizer

  - Query Transformer

    좀 더 나은 실행 계획을 갖는 SQL로 변환이 가능한지를 판단하여 변환 작업을 수행한다.

  - Estimator

    시스템 통계정보를 이용해 실행계획 전체에 대한 총비용을 계산한다.

  - Plan Generator

    Estimator를 통해 계산된 값들을 토대로 후보군이 되는 실행 계획들을 생성한다.

- Row-Source Generator

  옵티마이저가 생성한 실행계획을 SQL 엔진이 실행할 수 있는 코드 형태로 변환한다.

- SQL Engine

  SQL을 실행한다.
